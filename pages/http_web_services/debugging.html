
<!DOCTYPE html>
<!--[if IE 9]><html class="lt-ie10" lang="en" > <![endif]-->
<html class="no-js" lang="en" >
    <head>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <title>11.4.Â Debugging HTTP web services</title>
        <link rev="made" href="josh@servercobra.com" />
        <meta name="generator" content="convert_to_jinja2.py" />
        <meta name="keywords" content="Python, Dive Into Python, tutorial, object-oriented, programming, documentation, book, free" />
        <meta name="description" content="Python from novice to pro" />
        <link rel="home" href="http://www.diveintopython.net/" title="Dive Into Python" />
        
        <link rel="up" href="index.html" title=" Chapter11.HTTP Web Services" />
        
        
        
        <link rel="next" href="user_agent.html" title=" 11.5.Setting the User-Agent" />
        
         <link rel="stylesheet" href="../css/normalize.css">
         <link rel="stylesheet" href="../css/foundation.css">
         <link rel="stylesheet" href="../css/diveintopython.css" type="text/css" />


         <script src="../js/modernizr.js"></script>
    </head>
    <body>
        <div class="row">
            <div class="small-12 columns" id="Header">
                <div class="row">
                    <div class="small-11 columns">
                        
                        <td align="left" colspan="5" id="breadcrumb" valign="top">You are here: <a href="../index.html">Home</a>&#160;&gt;&#160;<a href="../toc/index.html">Dive Into Python</a>&#160;&gt;&#160;<a href="index.html">HTTP Web Services</a>&#160;&gt;&#160;<span class="thispage">Debugging HTTP web services</span></td>
                        
                    </div>
                    <div class="small-1 columns">
                        
                        <td align="right" id="navigation" valign="top">&#160;&#160;&#160;<a href="http_features.html" title="Prev: &#8220;Features of HTTP&#8221;">&lt;&lt;</a>&#160;&#160;&#160;<a href="user_agent.html" title="Next: &#8220;Setting the User-Agent&#8221;">&gt;&gt;</a></td>
                        
                    </div>
                </div>


                <div id="logocontainer">
                    <h1 id="logo"><a href="http://www.diveintopython.net/index.html" accesskey="1">Dive Into Python</a></h1>
                    <p id="tagline">Python from novice to pro</p>
                    <a href="http://www.amazon.com/gp/product/B001GIOFN8/ref=as_li_tf_tl?ie=UTF8&tag=diveintopython-20&linkCode=as2&camp=1789&creative=9325&creativeASIN=B001GIOFN8"><img src="../images/amazon-buy-button.gif"></a>
                </div>
            </div>
        </div>
        <div class="row">
            <div class="small-12 columns">
        
            </div>
        </div>
        <div class="row">
            <div class="small-12 columns">
        
            </div>
        </div>
        <div class="row">
            <div class="small-12 columns">
        
            </div>
        </div>
        <div class="row">
            <div class="small-12 columns">
        <div class="section" lang="en">
<div class="titlepage">
<div>
<div>
<h2 class="title"><a name="oa.debug"></a>11.4.&#160;Debugging HTTP web services
                  </h2>
</div>
</div>
<div></div>
</div>
<div class="abstract">
<p>First, let's turn on the debugging features of <span class="application">Python</span>'s HTTP library and see what's being sent over the wire.  This will be useful throughout the chapter, as you add more and
               more features.
            </p>
</div>
<div class="example"><a name="d0e27789"></a><h3 class="title">Example&#160;11.3.&#160;Debugging HTTP</h3><pre class="screen">
<tt class="prompt">&gt;&gt;&gt; </tt><span class="userinput"><span class="pykeyword">import</span> httplib</span>
<tt class="prompt">&gt;&gt;&gt; </tt><span class="userinput">httplib.HTTPConnection.debuglevel = 1</span>             <a name="oa.debug.1.1"></a><img alt="1" border="0" height="12" src="../images/callouts/1.png" width="12">
<tt class="prompt">&gt;&gt;&gt; </tt><span class="userinput"><span class="pykeyword">import</span> urllib</span>
<tt class="prompt">&gt;&gt;&gt; </tt><span class="userinput">feeddata = urllib.urlopen(<span class="pystring">'http://diveintomark.org/xml/atom.xml'</span>).read()</span>
<span class="computeroutput">connect: (diveintomark.org, 80)</span>                       <a name="oa.debug.1.2"></a><img alt="2" border="0" height="12" src="../images/callouts/2.png" width="12">
<span class="computeroutput">send: '</span>
<span class="computeroutput">GET /xml/atom.xml HTTP/1.0</span>                            <a name="oa.debug.1.3"></a><img alt="3" border="0" height="12" src="../images/callouts/3.png" width="12">
<span class="computeroutput">Host: diveintomark.org</span>                                <a name="oa.debug.1.4"></a><img alt="4" border="0" height="12" src="../images/callouts/4.png" width="12">
<span class="computeroutput">User-agent: Python-urllib/1.15</span>                        <a name="oa.debug.1.5"></a><img alt="5" border="0" height="12" src="../images/callouts/5.png" width="12">
<span class="computeroutput">'</span>
<span class="computeroutput">reply: 'HTTP/1.1 200 OK\r\n'</span>                          <a name="oa.debug.1.6"></a><img alt="6" border="0" height="12" src="../images/callouts/6.png" width="12">
<span class="computeroutput">header: Date: Wed, 14 Apr 2004 22:27:30 GMT</span>
<span class="computeroutput">header: Server: Apache/2.0.49 (Debian GNU/Linux)</span>
<span class="computeroutput">header: Content-Type: application/atom+xml</span>
<span class="computeroutput">header: Last-Modified: Wed, 14 Apr 2004 22:14:38 GMT</span>  <a name="oa.debug.1.7"></a><img alt="7" border="0" height="12" src="../images/callouts/7.png" width="12">
<span class="computeroutput">header: ETag: "e8284-68e0-4de30f80"</span>                   <a name="oa.debug.1.8"></a><img alt="8" border="0" height="12" src="../images/callouts/8.png" width="12">
<span class="computeroutput">header: Accept-Ranges: bytes</span>
<span class="computeroutput">header: Content-Length: 26848</span>
<span class="computeroutput">header: Connection: close</span>
</img></img></img></img></img></img></img></img></pre></div>
<div class="calloutlist">
<table border="0" summary="Callout list">
<tr>
<td align="left" valign="top" width="12"><a href="#oa.debug.1.1"><img alt="1" border="0" height="12" src="../images/callouts/1.png" width="12"/></a>
</td>
<td align="left" valign="top"><tt class="filename">urllib</tt> relies on another standard <span class="application">Python</span> library, <tt class="filename">httplib</tt>.  Normally you don't need to <tt class="literal">import httplib</tt> directly (<tt class="filename">urllib</tt> does that automatically), but you will here so you can set the debugging flag on the <tt class="classname">HTTPConnection</tt> class that <tt class="filename">urllib</tt> uses internally to connect to the HTTP server.  This is an incredibly useful technique.  Some other <span class="application">Python</span> libraries have similar debug flags, but there's no particular standard for naming them or turning them on; you need to read
                     the documentation of each library to see if such a feature is available.
                  </td>
</tr>
<tr>
<td align="left" valign="top" width="12"><a href="#oa.debug.1.2"><img alt="2" border="0" height="12" src="../images/callouts/2.png" width="12"/></a>
</td>
<td align="left" valign="top">Now that the debugging flag is set, information on the the HTTP request and response is printed out in real time.  The first
                     thing it tells you is that you're connecting to the server <tt class="literal">diveintomark.org</tt> on port 80, which is the standard port for HTTP.
                  </td>
</tr>
<tr>
<td align="left" valign="top" width="12"><a href="#oa.debug.1.3"><img alt="3" border="0" height="12" src="../images/callouts/3.png" width="12"/></a>
</td>
<td align="left" valign="top">When you request the Atom feed, <tt class="filename">urllib</tt> sends three lines to the server.  The first line specifies the HTTP verb you're using, and the path of the resource (minus
                     the domain name).  All the requests in this chapter will use <tt class="literal">GET</tt>, but in the next chapter on <span class="acronym">SOAP</span>, you'll see that it uses <tt class="literal">POST</tt> for everything.  The basic syntax is the same, regardless of the verb.
                  </td>
</tr>
<tr>
<td align="left" valign="top" width="12"><a href="#oa.debug.1.4"><img alt="4" border="0" height="12" src="../images/callouts/4.png" width="12"/></a>
</td>
<td align="left" valign="top">The second line is the <tt class="literal">Host</tt> header, which specifies the domain name of the service you're accessing.  This is important, because a single HTTP server
                     can host multiple separate domains.  My server currently hosts 12 domains; other servers can host hundreds or even thousands.
                  </td>
</tr>
<tr>
<td align="left" valign="top" width="12"><a href="#oa.debug.1.5"><img alt="5" border="0" height="12" src="../images/callouts/5.png" width="12"/></a>
</td>
<td align="left" valign="top">The third line is the <tt class="literal">User-Agent</tt> header.  What you see here is the generic <tt class="literal">User-Agent</tt> that the <tt class="filename">urllib</tt> library adds by default.  In the next section, you'll see how to customize this to be more specific.
                  </td>
</tr>
<tr>
<td align="left" valign="top" width="12"><a href="#oa.debug.1.6"><img alt="6" border="0" height="12" src="../images/callouts/6.png" width="12"/></a>
</td>
<td align="left" valign="top">The server replies with a status code and a bunch of headers (and possibly some data, which got stored in the <tt class="varname">feeddata</tt> variable).  The status code here is <tt class="literal">200</tt>, meaning &#8220;<span class="quote">everything's normal, here's the data you requested</span>&#8221;.  The server also tells you the date it responded to your request, some information about the server itself, and the content
                     type of the data it's giving you.  Depending on your application, this might be useful, or not.  It's certainly reassuring
                     that you thought you were asking for an Atom feed, and lo and behold, you're getting an Atom feed (<tt class="literal">application/atom+xml</tt>, which is the registered content type for Atom feeds).
                  </td>
</tr>
<tr>
<td align="left" valign="top" width="12"><a href="#oa.debug.1.7"><img alt="7" border="0" height="12" src="../images/callouts/7.png" width="12"/></a>
</td>
<td align="left" valign="top">The server tells you when this Atom feed was last modified (in this case, about 13 minutes ago).  You can send this date back
                     to the server the next time you request the same feed, and the server can do last-modified checking.
                  </td>
</tr>
<tr>
<td align="left" valign="top" width="12"><a href="#oa.debug.1.8"><img alt="8" border="0" height="12" src="../images/callouts/8.png" width="12"/></a>
</td>
<td align="left" valign="top">The server also tells you that this Atom feed has an ETag hash of <tt class="literal">"e8284-68e0-4de30f80"</tt>.  The hash doesn't mean anything by itself; there's nothing you can do with it, except send it back to the server the next
                     time you request this same feed.  Then the server can use it to tell you if the data has changed or not.
                  </td>
</tr>
</table>
</div>
</div>
            </div>
        </div>
        <div class="row">
            <div class="small-12 columns">
        <table border="0" cellpadding="0" cellspacing="0" class="Footer" summary="" width="100%">
<tr>
<td align="left" width="35%"><br><a class="NavigationArrow" href="http_features.html">&lt;&lt;&#160;Features of HTTP</a></br></td>
<td align="center" width="30%"><br>&#160;<span class="divider">|</span>&#160;<a href="index.html#oa.divein" title="11.1.&#160;Diving in">1</a> <span class="divider">|</span> <a href="review.html" title="11.2.&#160;How not to fetch data over HTTP">2</a> <span class="divider">|</span> <a href="http_features.html" title="11.3.&#160;Features of HTTP">3</a> <span class="divider">|</span> <span class="thispage">4</span> <span class="divider">|</span> <a href="user_agent.html" title="11.5.&#160;Setting the User-Agent">5</a> <span class="divider">|</span> <a href="etags.html" title="11.6.&#160;Handling Last-Modified and ETag">6</a> <span class="divider">|</span> <a href="redirects.html" title="11.7.&#160;Handling redirects">7</a> <span class="divider">|</span> <a href="gzip_compression.html" title="11.8.&#160;Handling compressed data">8</a> <span class="divider">|</span> <a href="alltogether.html" title="11.9.&#160;Putting it all together">9</a> <span class="divider">|</span> <a href="summary.html" title="11.10.&#160;Summary">10</a>&#160;<span class="divider">|</span>&#160;
            </br></td>
<td align="right" width="35%"><br><a class="NavigationArrow" href="user_agent.html">Setting the User-Agent&#160;&gt;&gt;</a></br></td>
</tr>
<tr>
<td colspan="3"><br/></td>
</tr>
</table>
        <!-- Footer -->
<div class="Footer">
    <p><a href="https://github.com/pcsforeducation/diveintopython/issues?sort=created&state=open">Report issues<img style="margin-left:10px" height="40" src="../images/logo_github.png"></a></p>
    <p class="copyright">Copyright &copy; 2000, 2001, 2002, 2003, 2004 <a href="mailto:josh@servercobra.com">Mark Pilgrim</a>. Maintained by Josh Gachnang.</p>
</div>
<script type="text/javascript"><!--
google_ad_client = "ca-pub-1879314568120827";
/* DiveIntoPython */
google_ad_slot = "8002881514";
google_ad_width = 468;
google_ad_height = 60;
//-->
</script>
<script type="text/javascript"
src="http://pagead2.googlesyndication.com/pagead/show_ads.js">
</script>
<!-- End Footer -->
            </div>
        </div>
        <!-- Google Analytics -->
<script type="text/javascript">

  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-9740779-18']);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();

</script>
<!-- End Google Analytics -->
        <script src="../js/jquery.js"></script>
        <script src="../js/foundation.min.js"></script>
        <script>
          $(document).foundation();
        </script>
    </body>
</html>